# Model Documentation - v1.0 Baseline

## Model Architecture

### Overview
- **Type**: Gradient Boosting (LightGBM)
- **Task**: Multi-class classification (4 classes)
- **Strategy**: Separate models for enter and exit ratings

### Models

#### Enter Rating Model
- **File**: `models/quick_enter_model.pkl`
- **Classes**: 4 (free flowing, light delay, moderate delay, heavy delay)
- **Training samples**: 12,860
- **Validation samples**: 3,216

**Hyperparameters**:
```python
{
    'objective': 'multiclass',
    'num_class': 4,
    'n_estimators': 100,
    'learning_rate': 0.05,
    'num_leaves': 31,
    'feature_fraction': 0.9,
    'bagging_fraction': 0.8,
    'bagging_freq': 5,
    'random_state': 42
}
```

**Performance**:
- Validation Accuracy: 0.8321
- Validation F1 (weighted): 0.8293

#### Exit Rating Model
- **File**: `models/quick_exit_model.pkl`
- **Classes**: 4 (free flowing, light delay, moderate delay, heavy delay)
- **Training samples**: 12,860
- **Validation samples**: 3,216

**Hyperparameters**: Same as enter rating model

**Performance**:
- Validation Accuracy: 0.9627
- Validation F1 (weighted): 0.9601

## Features (37 total)

### Temporal Features (12)
1. `time_segment_id` - Segment identifier
2. `hour` - Hour of day (0-23)
3. `minute` - Minute of hour (0-59)
4. `day_of_week` - Day of week (0=Monday, 6=Sunday)
5. `day_of_month` - Day of month (1-31)
6. `is_weekend` - Binary (0/1)
7. `is_rush_hour` - Binary (0/1) - 7-9 AM or 4-6 PM
8. `hour_sin` - Cyclical encoding of hour
9. `hour_cos` - Cyclical encoding of hour
10. `day_sin` - Cyclical encoding of day
11. `day_cos` - Cyclical encoding of day
12. `segment_duration` - Duration in seconds

### Categorical Features (3)
13. `view_label_encoded` - Location encoding (0-3)
14. `signaling_encoded` - Traffic signal status (0-3)
15. `time_of_day_encoded` - Time category (0-3)

### Lag Features (10)
Enter rating lags:
16. `congestion_enter_rating_lag_1`
17. `congestion_enter_rating_lag_2`
18. `congestion_enter_rating_lag_3`
19. `congestion_enter_rating_lag_5`
20. `congestion_enter_rating_lag_10`

Exit rating lags:
21. `congestion_exit_rating_lag_1`
22. `congestion_exit_rating_lag_2`
23. `congestion_exit_rating_lag_3`
24. `congestion_exit_rating_lag_5`
25. `congestion_exit_rating_lag_10`

### Rolling Statistics (12)
Enter rating rolling features:
26. `congestion_enter_rating_rolling_mean_5`
27. `congestion_enter_rating_rolling_std_5`
28. `congestion_enter_rating_rolling_mean_10`
29. `congestion_enter_rating_rolling_std_10`
30. `congestion_enter_rating_rolling_mean_20`
31. `congestion_enter_rating_rolling_std_20`

Exit rating rolling features:
32. `congestion_exit_rating_rolling_mean_5`
33. `congestion_exit_rating_rolling_std_5`
34. `congestion_exit_rating_rolling_mean_10`
35. `congestion_exit_rating_rolling_std_10`
36. `congestion_exit_rating_rolling_mean_20`
37. `congestion_exit_rating_rolling_std_20`

## Training Process

### Data Split
- **Method**: Time-aware chronological split
- **Train**: First 80% (12,860 samples)
- **Validation**: Last 20% (3,216 samples)
- **Rationale**: Prevents data leakage, mimics real-world deployment

### Preprocessing
1. Parse datetime features
2. Create cyclical encodings
3. Encode categorical variables
4. Generate lag features (per location)
5. Calculate rolling statistics
6. Fill missing values with 0

### Training
- No class weighting applied (v1.0)
- No early stopping
- Single train/val split (no cross-validation)

## Limitations

1. **Class Imbalance**: Exit ratings heavily imbalanced (95% free flowing)
2. **No Cross-Validation**: Single split may not be representative
3. **Limited Hyperparameter Tuning**: Default parameters used
4. **Missing Values**: Lag features have NaN for first segments
5. **No Ensemble**: Single model per target

## Improvements for Next Version

1. Implement SMOTE for class balancing
2. Add cross-validation (TimeSeriesSplit)
3. Hyperparameter tuning
4. More sophisticated feature engineering
5. Ensemble multiple models
