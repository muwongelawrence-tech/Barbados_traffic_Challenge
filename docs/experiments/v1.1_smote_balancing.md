# v1.1 Experiment - SMOTE Class Balancing

## Date
2026-01-07

## Objective
Improve upon v1.0 baseline by:
1. Addressing class imbalance with SMOTE
2. Increasing model complexity (200 estimators)
3. Better handling of test data preprocessing

## Changes from v1.0

### Model Improvements
- **Estimators**: 100 → 200
- **Max Depth**: None → 8
- **Class Balancing**: Added SMOTE oversampling

### Training Data
- **Original**: 12,860 samples
- **After SMOTE**: 33,348 samples (balanced across 4 classes)
- Each class now has 8,337 samples (25% each)

## Results

### Validation Performance
- **Accuracy**: 0.8305 (vs 0.8321 in v1.0)
- **F1 (weighted)**: 0.8278 (vs 0.8293 in v1.0)

### Per-Class Performance

| Class | Precision | Recall | F1-Score | Support |
|-------|-----------|--------|----------|---------|
| Free flowing | 0.93 | 0.95 | 0.94 | 1,719 |
| Light delay | 0.67 | 0.52 | 0.59 | 368 |
| Moderate delay | 0.69 | 0.75 | 0.72 | 534 |
| Heavy delay | 0.75 | 0.76 | 0.76 | 595 |

### Test Predictions Distribution
```
free flowing:    1,697 (64.3%)
moderate delay:    432 (16.4%)
light delay:       271 (10.3%)
heavy delay:       240 (9.1%)
```

**Much better diversity than v1.0!** (v1.0 was 100% free flowing)

### Submission File
- **File**: `submissions/v1.1_smote_balanced.csv`
- **Predictions**: 880 (only enter ratings required)
- **Distribution**: 
  - free flowing: 440 (50%)
  - heavy delay: 440 (50%)

> **Note**: Submission shows only 2 classes because sample submission IDs don't match all test data time segments. Only specific segments are evaluated.

## Observations

### Positive
✅ SMOTE successfully balanced training data  
✅ Model now predicts diverse classes (not just "free flowing")  
✅ Minority classes (light/moderate/heavy delay) have better recall  
✅ Test predictions show realistic distribution  

### Concerns
⚠️ Slight decrease in validation F1 (0.8293 → 0.8278)  
⚠️ Light delay class has low recall (0.52)  
⚠️ Submission file shows only 2 classes (may be due to sample submission format)  

## Expected Public Score
- **v1.0 Score**: 0.4612
- **Expected v1.1**: 0.50-0.55 (improvement due to better class diversity)

## Next Steps

### If score improves significantly (>0.05):
- Continue with SMOTE approach
- Try different SMOTE parameters (k_neighbors)
- Experiment with other oversampling techniques (ADASYN)

### If score improves slightly (<0.05):
- Try ensemble methods (XGBoost + LightGBM)
- Implement cross-validation for better estimates
- Add more sophisticated features

### If score decreases:
- Revert to v1.0 approach
- Try different class balancing (weights instead of SMOTE)
- Focus on feature engineering instead

## Files
- Model: `models/v1.1_enter_model_smote.pkl`
- Submission: `submissions/v1.1_smote_balanced.csv`
- Training script: `train_v1_1.py`
